<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TODAY-CHEON - 관리자 대시보드</title>
  <link rel="stylesheet" href="/css/font.css" />
  <link rel="stylesheet" href="/css/common.css" />
  <link rel="stylesheet" href="/css/inner.css" />
  <link rel="stylesheet" href="/css/dashboard.css" />
</head>
<body>
  <header>
    <div class="header-left">
      <i class="logo-icon"></i>
      <a href="/">TODAY-CHEON</a>
    </div>
    <div class="header-right">
      <a>관리자</a>
      <button onclick="location.href='/auth/logout'">로그아웃</button>
    </div>
  </header>
  <main>
    <section class="dashboard">
      <h2 class="dashboard-title">맛집 등록 승인 대기 목록</h2>
      <table class="dashboard-table">
        <thead>
          <tr>
            <th>No</th>
            <th>유저 아이디</th>
            <th>맛집 이름</th>
            <th>주소</th>
            <th>카카오 맵</th>
            <th>카테고리</th>
            <th>설명</th>
            <th>영업 시간</th>
            <th>승인 관리</th>
          </tr>
        </thead>
        <tbody>
          {% for store in stores %}
          <tr>
            <td>{{ store.index }}</td>
            <td>{{ store.userId }}</td>
            <td>{{ store.name }}</td>
            <td>{{ store.address }}</td>
            <td>
              <a
                href="{{ store.kakaoMapUrl }}"
                target="_blank"
                class="map-link"
              >
                {{ store.address }}
              </a>
            </td>
            <td>{{ store.category or '-' }}</td>
            <td>{{ store.description or '-' }}</td>
            <td>
              <input
                type="time"
                name="openStart"
                value="{{ store.openTime.start }}"
                class="open-time-input"
              />
              ~
              <input
                type="time"
                name="openEnd"
                value="{{ store.openTime.end }}"
                class="open-time-input"
              />
            </td>
            <td>
              <button class="approve-btn" data-id="{{ store.index }}">승인</button>
              <button class="reject-btn" data-id="{{ store.index }}">거절</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </main>

  <footer>
    <div class="footer-left">
      <p>©2025 ToCheon(Ho)</p>
    </div>
    <div class="footer-middle">
      <a>개인정보처리방침</a>
      <a>이용약관</a>
      <a>문의하기</a>
    </div>
    <div class="footer-right">
      <i class="linktree-icon"></i>
      <i class="github-icon"></i>
    </div>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const approveBtns = document.querySelectorAll(".approve-btn");
      const rejectBtns = document.querySelectorAll(".reject-btn");

      approveBtns.forEach((btn) => {
        btn.addEventListener("click", async () => {
          const id = btn.dataset.id;
          await fetch(`/api/admin/stores/${id}/approve`, { method: "POST" });
          location.reload();
        });
      });

      rejectBtns.forEach((btn) => {
        btn.addEventListener("click", async () => {
          const id = btn.dataset.id;
          await fetch(`/api/admin/stores/${id}/reject`, { method: "POST" });
          location.reload();
        });
      });
    });
  </script>
</body>
</html>
